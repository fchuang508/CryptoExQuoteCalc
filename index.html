<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CryptoExQuoteCalc</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body class="p-4">
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    function App() {
      const [ethUsd, setEthUsd] = useState(3000);
      const [usdCny, setUsdCny] = useState(7);
      const [gas, setGas] = useState(20);
      const [buyPremium, setBuyPremium] = useState(2);
      const [sellPremium, setSellPremium] = useState(2);
      const [ethAmount, setEthAmount] = useState(1);
      const [rmbAmount, setRmbAmount] = useState('');

      const marketPrice = ethUsd * usdCny;
      const buyPrice = marketPrice * (1 + buyPremium / 100) + gas;
      const sellPrice = marketPrice * (1 - sellPremium / 100) - gas;
      const profitBuy = marketPrice * buyPremium / 100;
      const profitSell = marketPrice * sellPremium / 100;

      const handleEthChange = (e) => {
        setEthAmount(e.target.value);
        setRmbAmount('');
      };

      const handleRmbChange = (e) => {
        setRmbAmount(e.target.value);
        setEthAmount('');
      };

      const ethTotal = rmbAmount !== '' ? (parseFloat(rmbAmount) || 0) / marketPrice : (parseFloat(ethAmount) || 0);
      const rmbTotal = ethTotal * marketPrice;
      const buyTotal = marketPrice * ethTotal * (1 + buyPremium / 100) + gas;
      const sellTotal = marketPrice * ethTotal * (1 - sellPremium / 100) - gas;
      const profitBuyTotal = buyTotal - (marketPrice * ethTotal + gas);
      const profitSellTotal = (marketPrice * ethTotal - gas) - sellTotal;

      const copyText = (type) => {
        const text = type === 'buy'
          ? `Buy ${ethTotal.toFixed(4)} ETH @ ${buyPrice.toFixed(2)} RMB (total ${buyTotal.toFixed(2)} RMB)`
          : `Sell ${ethTotal.toFixed(4)} ETH @ ${sellPrice.toFixed(2)} RMB (total ${sellTotal.toFixed(2)} RMB)`;
        navigator.clipboard.writeText(text);
      };

      const reset = () => {
        setEthUsd(3000);
        setUsdCny(7);
        setGas(20);
        setBuyPremium(2);
        setSellPremium(2);
        setEthAmount(1);
        setRmbAmount('');
      };

      return (
        <div className="max-w-xl mx-auto space-y-4">
          <h1 className="text-2xl font-bold">CryptoExQuoteCalc</h1>
          <div className="grid grid-cols-2 gap-4">
            <label className="flex flex-col">ETH/USD
              <input type="number" className="border p-1" value={ethUsd} onChange={e => setEthUsd(parseFloat(e.target.value) || 0)} />
            </label>
            <label className="flex flex-col">USD/CNY
              <input type="number" className="border p-1" value={usdCny} onChange={e => setUsdCny(parseFloat(e.target.value) || 0)} />
            </label>
            <label className="flex flex-col">Gas Cost (RMB)
              <input type="number" className="border p-1" value={gas} onChange={e => setGas(parseFloat(e.target.value) || 0)} />
            </label>
            <label className="flex flex-col">Buy Premium %
              <input type="number" className="border p-1" value={buyPremium} onChange={e => setBuyPremium(parseFloat(e.target.value) || 0)} />
            </label>
            <label className="flex flex-col">Sell Premium %
              <input type="number" className="border p-1" value={sellPremium} onChange={e => setSellPremium(parseFloat(e.target.value) || 0)} />
            </label>
            <label className="flex flex-col">Amount ETH
              <input type="number" className="border p-1" value={ethAmount} onChange={handleEthChange} placeholder="1" />
            </label>
            <label className="flex flex-col">Amount RMB
              <input type="number" className="border p-1" value={rmbAmount} onChange={handleRmbChange} placeholder="auto" />
            </label>
          </div>

          <div className="border p-4 space-y-2">
            <div>Market Price: {marketPrice.toFixed(2)} RMB / ETH</div>
            <div>Buy Price: {buyPrice.toFixed(2)} RMB / ETH (Profit {profitBuy.toFixed(2)})</div>
            <div>Sell Price: {sellPrice.toFixed(2)} RMB / ETH (Profit {profitSell.toFixed(2)})</div>
          </div>

          <div className="border p-4 space-y-2">
            <div>Market Total: {rmbTotal.toFixed(2)} RMB</div>
            <div>Buy Total: {buyTotal.toFixed(2)} RMB (Profit {profitBuyTotal.toFixed(2)})</div>
            <div>Sell Total: {sellTotal.toFixed(2)} RMB (Profit {profitSellTotal.toFixed(2)})</div>
          </div>

          <div className="flex gap-2">
            <button className="px-2 py-1 bg-blue-500 text-white" onClick={() => copyText('buy')}>Copy Buy</button>
            <button className="px-2 py-1 bg-green-500 text-white" onClick={() => copyText('sell')}>Copy Sell</button>
            <button className="px-2 py-1 bg-gray-300" onClick={reset}>Reset</button>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
